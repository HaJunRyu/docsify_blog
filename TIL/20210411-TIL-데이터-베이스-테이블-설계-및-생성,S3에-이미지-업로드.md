# 2021년 04월 11일 일요일 TIL(데이터 베이스 테이블 설계 및 생성, S3에 이미지 업로드)

## 오늘 한 일과 느낀점
MySQL workbench ERR을 이용하여 devfolio 프로젝트에 필요한 테이블들을 만들었다. 직접 ERR을 그려보니 기획단계에서 보이지 않았던 복잡성이 보였고 아마 댓글 기능은 최소구현 기능에서 제외하고 진행해야 할 것 같다는 생각이 들었다.  

그 이후 해커톤때 진행했던 코드를 기반으로 AWS S3에 이미지를 업로드하는 엔드포인트를 만들고 클라이언트에서 파일을 전송하면 업로드 되게끔 로직을 작성하였다.  

로그인 기능 구현을 위해 JWT와 세션에 대해 알아보았다. 생각보다 많은 시간을 할애하게 됐고 일단 지난 Vanila Javascript프로젝트에서 진행했던 realworld 오픈소스에서 jwt를 제공해줬었는데 이것을 가지고 다른 PC에서 그냥 쿠키나 로컬스토리지에 넣어주니 인증이 정상적으로 되었고 보안에 취약하다는 느낌이 강하게 들어 세션을 알아보았다. 그래서 보안을 생각하면 사실 무조건 세션으로 진행하는게 맞다고 생각되어 세션으로 하려고 했지만 계속 이것에 대한 시간 투자가 늘어났고 나의 PC가 아닌 aws ec2 인스턴스를 쓰는것이기 때문에 서버에 인증 기능을 의존하는것도 조금 꺼림찍했다. 이번 프로젝트의 중점이 프론트엔드 중심이다 보니 빠르게 JWT를 발급하여 쿠키로 인증을 진행하기로 마음먹었고 서버에서 로직을 작성하여 클라이언트에서 요청을 보내봤다. 근데 여기서 또 예상치 못한 시행착오가 있었는데 postman에서 요청하면 쿠키가 잘 저장됐는데 브라우저에서는 cookie가 저장되지 않는 이슈가 있었다. 이유는 간단히 브라우저의 쿠키 보안정책상 fetch메서드와 axios요청은 기본적으로 쿠키를 주고받지 않는다고 한다. 그래서 요청을 할때 credentials 설정을 include로 바꿔주고 mode를 no-cors로 바꿔줘야 했다.

## 내일 할 일
- signin엔드포인트에서 JWT토근 발급하여 브라우저에 저장하는 기능 구현

- Google, Github 회원가입, 로그인 API 서버에서 사용할 수 있게끔 공부하고 구현하기

- 서버에서 MySQL을 접근할 수 있게끔 하고 시간이 된다면 일반 회원가입과 로그인 API생성